-module(test_ngap).
-include("dump_packet.hrl").

-export([dump_sctp_packet/2, testFull/0, test/0]).

dump_sctp_packet(HexStr, NameFile) ->
	BinData = hex_dump:parse_hex_str(HexStr),
	pcap_api:new_pcap(NameFile),
	NGAPBIN = <<BinData/binary>>,
	pcap_api:append_pcap(NameFile, 0, 0, #sctp_data_packet{proto = 0, sport = 39410, dport = 38412, data = NGAPBIN}, []).

test() ->
	{ok, File} = file:open("../output/test.bin",[read]),
	{ok, HexStr} = file:read(File,1024*1024),
	dump_sctp_packet(HexStr, "../output/test.pcap").

testFull() ->
	%%init
	{ok, File11} = file:open("bin/init/AMFConfigurationUpdate.bin",[read]),
	{ok, HexStr11} = file:read(File11,1024*1024),
	dump_sctp_packet(HexStr11, "pcap/init/AMFConfigurationUpdate.pcap"),
	{ok, File12} = file:open("bin/init/HandoverCancel.bin",[read]),
	{ok, HexStr12} = file:read(File12,1024*1024),
	dump_sctp_packet(HexStr12, "pcap/init/HandoverCancel.pcap"),
	{ok, File13} = file:open("bin/init/HandoverRequired.bin",[read]),
	{ok, HexStr13} = file:read(File13,1024*1024),
	dump_sctp_packet(HexStr13, "pcap/init/HandoverRequired.pcap"),
	{ok, File14} = file:open("bin/init/HandoverRequest.bin",[read]),
	{ok, HexStr14} = file:read(File14,1024*1024),
	dump_sctp_packet(HexStr14, "pcap/init/HandoverRequest.pcap"),
	{ok, File15} = file:open("bin/init/InitialContextSetupRequest.bin",[read]),
	{ok, HexStr15} = file:read(File15,1024*1024),
	dump_sctp_packet(HexStr15, "pcap/init/InitialContextSetupRequest.pcap"),
	{ok, File16} = file:open("bin/init/NGReset.bin",[read]),
	{ok, HexStr16} = file:read(File16,1024*1024),
	dump_sctp_packet(HexStr16, "pcap/init/NGReset.pcap"),
	{ok, File17} = file:open("bin/init/NGSetupRequest.bin",[read]),
	{ok, HexStr17} = file:read(File17,1024*1024),
	dump_sctp_packet(HexStr17, "pcap/init/NGSetupRequest.pcap"),
	{ok, File18} = file:open("bin/init/PathSwitchRequest.bin",[read]),
	{ok, HexStr18} = file:read(File18,1024*1024),
	dump_sctp_packet(HexStr18, "pcap/init/PathSwitchRequest.pcap"),
	{ok, File19} = file:open("bin/init/PDUSessionResourceModifyRequest.bin",[read]),
	{ok, HexStr19} = file:read(File19,1024*1024),
	dump_sctp_packet(HexStr19, "pcap/init/PDUSessionResourceModifyRequest.pcap"),
	{ok, File110} = file:open("bin/init/PDUSessionResourceModifyIndication.bin",[read]),
	{ok, HexStr110} = file:read(File110,1024*1024),
	dump_sctp_packet(HexStr110, "pcap/init/PDUSessionResourceModifyIndication.pcap"),
	{ok, File111} = file:open("bin/init/PDUSessionResourceReleaseCommand.bin",[read]),
	{ok, HexStr111} = file:read(File111,1024*1024),
	dump_sctp_packet(HexStr111, "pcap/init/PDUSessionResourceReleaseCommand.pcap"),
	{ok, File112} = file:open("bin/init/PDUSessionResourceSetupRequest.bin",[read]),
	{ok, HexStr112} = file:read(File112,1024*1024),
	dump_sctp_packet(HexStr112, "pcap/init/PDUSessionResourceSetupRequest.pcap"),
	{ok, File113} = file:open("bin/init/PWSCancelRequest.bin",[read]),
	{ok, HexStr113} = file:read(File113,1024*1024),
	dump_sctp_packet(HexStr113, "pcap/init/PWSCancelRequest.pcap"),
	{ok, File114} = file:open("bin/init/RANConfigurationUpdate.bin",[read]),
	{ok, HexStr114} = file:read(File114,1024*1024),
	dump_sctp_packet(HexStr114, "pcap/init/RANConfigurationUpdate.pcap"),
	{ok, File115} = file:open("bin/init/UEContextModificationRequest.bin",[read]),
	{ok, HexStr115} = file:read(File115,1024*1024),
	dump_sctp_packet(HexStr115, "pcap/init/UEContextModificationRequest.pcap"),
	{ok, File116} = file:open("bin/init/UEContextReleaseCommand.bin",[read]),
	{ok, HexStr116} = file:read(File116,1024*1024),
	dump_sctp_packet(HexStr116, "pcap/init/UEContextReleaseCommand.pcap"),
	{ok, File117} = file:open("bin/init/UERadioCapabilityCheckRequest.bin",[read]),
	{ok, HexStr117} = file:read(File117,1024*1024),
	dump_sctp_packet(HexStr117, "pcap/init/UERadioCapabilityCheckRequest.pcap"),
	{ok, File118} = file:open("bin/init/WriteReplaceWarningRequest.bin",[read]),
	{ok, HexStr118} = file:read(File118,1024*1024),
	dump_sctp_packet(HexStr118, "pcap/init/WriteReplaceWarningRequest.pcap"),
	{ok, File119} = file:open("bin/init/AMFStatusIndication.bin",[read]),
	{ok, HexStr119} = file:read(File119,1024*1024),
	dump_sctp_packet(HexStr119, "pcap/init/AMFStatusIndication.pcap"),
	{ok, File120} = file:open("bin/init/CellTrafficTrace.bin",[read]),
	{ok, HexStr120} = file:read(File120,1024*1024),
	dump_sctp_packet(HexStr120, "pcap/init/CellTrafficTrace.pcap"),
	{ok, File121} = file:open("bin/init/DeactivateTrace.bin",[read]),
	{ok, HexStr121} = file:read(File121,1024*1024),
	dump_sctp_packet(HexStr121, "pcap/init/DeactivateTrace.pcap"),
	{ok, File122} = file:open("bin/init/DownlinkNASTransport.bin",[read]),
	{ok, HexStr122} = file:read(File122,1024*1024),
	dump_sctp_packet(HexStr122, "pcap/init/DownlinkNASTransport.pcap"),
	{ok, File123} = file:open("bin/init/DownlinkNonUEAssociatedNRPPaTransport.bin",[read]),
	{ok, HexStr123} = file:read(File123,1024*1024),
	dump_sctp_packet(HexStr123, "pcap/init/DownlinkNonUEAssociatedNRPPaTransport.pcap"),
	{ok, File124} = file:open("bin/init/DownlinkRANConfigurationTransfer.bin",[read]),
	{ok, HexStr124} = file:read(File124,1024*1024),
	dump_sctp_packet(HexStr124, "pcap/init/DownlinkRANConfigurationTransfer.pcap"),
	{ok, File125} = file:open("bin/init/DownlinkRANStatusTransfer.bin",[read]),
	{ok, HexStr125} = file:read(File125,1024*1024),
	dump_sctp_packet(HexStr125, "pcap/init/DownlinkRANStatusTransfer.pcap"),
	{ok, File126} = file:open("bin/init/DownlinkUEAssociatedNRPPaTransport.bin",[read]),
	{ok, HexStr126} = file:read(File126,1024*1024),
	dump_sctp_packet(HexStr126, "pcap/init/DownlinkUEAssociatedNRPPaTransport.pcap"),
	{ok, File127} = file:open("bin/init/ErrorIndication.bin",[read]),
	{ok, HexStr127} = file:read(File127,1024*1024),
	dump_sctp_packet(HexStr127, "pcap/init/ErrorIndication.pcap"),
	{ok, File128} = file:open("bin/init/HandoverNotify.bin",[read]),
	{ok, HexStr128} = file:read(File128,1024*1024),
	dump_sctp_packet(HexStr128, "pcap/init/HandoverNotify.pcap"),
	{ok, File129} = file:open("bin/init/InitialUEMessage.bin",[read]),
	{ok, HexStr129} = file:read(File129,1024*1024),
	dump_sctp_packet(HexStr129, "pcap/init/InitialUEMessage.pcap"),
	{ok, File130} = file:open("bin/init/LocationReport.bin",[read]),
	{ok, HexStr130} = file:read(File130,1024*1024),
	dump_sctp_packet(HexStr130, "pcap/init/LocationReport.pcap"),
	{ok, File131} = file:open("bin/init/LocationReportingControl.bin",[read]),
	{ok, HexStr131} = file:read(File131,1024*1024),
	dump_sctp_packet(HexStr131, "pcap/init/LocationReportingControl.pcap"),
	{ok, File132} = file:open("bin/init/LocationReportingFailureIndication.bin",[read]),
	{ok, HexStr132} = file:read(File132,1024*1024),
	dump_sctp_packet(HexStr132, "pcap/init/LocationReportingFailureIndication.pcap"),
	{ok, File133} = file:open("bin/init/NASNonDeliveryIndication.bin",[read]),
	{ok, HexStr133} = file:read(File133,1024*1024),
	dump_sctp_packet(HexStr133, "pcap/init/NASNonDeliveryIndication.pcap"),
	{ok, File134} = file:open("bin/init/OverloadStart.bin",[read]),
	{ok, HexStr134} = file:read(File134,1024*1024),
	dump_sctp_packet(HexStr134, "pcap/init/OverloadStart.pcap"),
	%%{ok, File135} = file:open("bin/init/OverloadStop.bin",[read]),
	%%{ok, HexStr135} = file:read(File135,1024*1024),
	%%dump_sctp_packet(HexStr135, "pcap/init/OverloadStop.pcap"),
	{ok, File136} = file:open("bin/init/Paging.bin",[read]),
	{ok, HexStr136} = file:read(File136,1024*1024),
	dump_sctp_packet(HexStr136, "pcap/init/Paging.pcap"),
	{ok, File137} = file:open("bin/init/PDUSessionResourceNotify.bin",[read]),
	{ok, HexStr137} = file:read(File137,1024*1024),
	dump_sctp_packet(HexStr137, "pcap/init/PDUSessionResourceNotify.pcap"),
	%%{ok, File138} = file:open("bin/init/PrivateMessage.bin",[read]),
	%%{ok, HexStr138} = file:read(File138,1024*1024),
	%%dump_sctp_packet(HexStr138, "pcap/init/PrivateMessage.pcap"),
	{ok, File139} = file:open("bin/init/PWSFailureIndication.bin",[read]),
	{ok, HexStr139} = file:read(File139,1024*1024),
	dump_sctp_packet(HexStr139, "pcap/init/PWSFailureIndication.pcap"),
	{ok, File140} = file:open("bin/init/PWSRestartIndication.bin",[read]),
	{ok, HexStr140} = file:read(File140,1024*1024),
	dump_sctp_packet(HexStr140, "pcap/init/PWSRestartIndication.pcap"),
	{ok, File141} = file:open("bin/init/RerouteNASRequest.bin",[read]),
	{ok, HexStr141} = file:read(File141,1024*1024),
	dump_sctp_packet(HexStr141, "pcap/init/RerouteNASRequest.pcap"),
	{ok, File142} = file:open("bin/init/RRCInactiveTransitionReport.bin",[read]),
	{ok, HexStr142} = file:read(File142,1024*1024),
	dump_sctp_packet(HexStr142, "pcap/init/RRCInactiveTransitionReport.pcap"),
	{ok, File143} = file:open("bin/init/TraceFailureIndication.bin",[read]),
	{ok, HexStr143} = file:read(File143,1024*1024),
	dump_sctp_packet(HexStr143, "pcap/init/TraceFailureIndication.pcap"),
	{ok, File144} = file:open("bin/init/TraceStart.bin",[read]),
	{ok, HexStr144} = file:read(File144,1024*1024),
	dump_sctp_packet(HexStr144, "pcap/init/TraceStart.pcap"),
	{ok, File145} = file:open("bin/init/UEContextReleaseRequest.bin",[read]),
	{ok, HexStr145} = file:read(File145,1024*1024),
	dump_sctp_packet(HexStr145, "pcap/init/UEContextReleaseRequest.pcap"),
	{ok, File146} = file:open("bin/init/UERadioCapabilityInfoIndication.bin",[read]),
	{ok, HexStr146} = file:read(File146,1024*1024),
	dump_sctp_packet(HexStr146, "pcap/init/UERadioCapabilityInfoIndication.pcap"),
	{ok, File147} = file:open("bin/init/UETNLABindingReleaseRequest.bin",[read]),
	{ok, HexStr147} = file:read(File147,1024*1024),
	dump_sctp_packet(HexStr147, "pcap/init/UETNLABindingReleaseRequest.pcap"),
	{ok, File148} = file:open("bin/init/UplinkNASTransport.bin",[read]),
	{ok, HexStr148} = file:read(File148,1024*1024),
	dump_sctp_packet(HexStr148, "pcap/init/UplinkNASTransport.pcap"),
	{ok, File149} = file:open("bin/init/UplinkNonUEAssociatedNRPPaTransport.bin",[read]),
	{ok, HexStr149} = file:read(File149,1024*1024),
	dump_sctp_packet(HexStr149, "pcap/init/UplinkNonUEAssociatedNRPPaTransport.pcap"),
	{ok, File150} = file:open("bin/init/UplinkRANConfigurationTransfer.bin",[read]),
	{ok, HexStr150} = file:read(File150,1024*1024),
	dump_sctp_packet(HexStr150, "pcap/init/UplinkRANConfigurationTransfer.pcap"),
	{ok, File151} = file:open("bin/init/UplinkRANStatusTransfer.bin",[read]),
	{ok, HexStr151} = file:read(File151,1024*1024),
	dump_sctp_packet(HexStr151, "pcap/init/UplinkRANStatusTransfer.pcap"),
	{ok, File152} = file:open("bin/init/UplinkUEAssociatedNRPPaTransport.bin",[read]),
	{ok, HexStr152} = file:read(File152,1024*1024),
	dump_sctp_packet(HexStr152, "pcap/init/UplinkUEAssociatedNRPPaTransport.pcap"),

	%%succ
	{ok, File21} = file:open("bin/succ/AMFConfigurationUpdateAcknowledge.bin",[read]),
	{ok, HexStr21} = file:read(File21,1024*1024),
	dump_sctp_packet(HexStr21, "pcap/succ/AMFConfigurationUpdateAcknowledge.pcap"),
	{ok, File22} = file:open("bin/succ/HandoverCancelAcknowledge.bin",[read]),
	{ok, HexStr22} = file:read(File22,1024*1024),
	dump_sctp_packet(HexStr22, "pcap/succ/HandoverCancelAcknowledge.pcap"),
	{ok, File23} = file:open("bin/succ/HandoverCommand.bin",[read]),
	{ok, HexStr23} = file:read(File23,1024*1024),
	dump_sctp_packet(HexStr23, "pcap/succ/HandoverCommand.pcap"),
	{ok, File24} = file:open("bin/succ/HandoverRequestAcknowledge.bin",[read]),
	{ok, HexStr24} = file:read(File24,1024*1024),
	dump_sctp_packet(HexStr24, "pcap/succ/HandoverRequestAcknowledge.pcap"),
	{ok, File25} = file:open("bin/succ/InitialContextSetupResponse.bin",[read]),
	{ok, HexStr25} = file:read(File25,1024*1024),
	dump_sctp_packet(HexStr25, "pcap/succ/InitialContextSetupResponse.pcap"),
	{ok, File26} = file:open("bin/succ/NGResetAcknowledge.bin",[read]),
	{ok, HexStr26} = file:read(File26,1024*1024),
	dump_sctp_packet(HexStr26, "pcap/succ/NGResetAcknowledge.pcap"),
	{ok, File27} = file:open("bin/succ/NGSetupResponse.bin",[read]),
	{ok, HexStr27} = file:read(File27,1024*1024),
	dump_sctp_packet(HexStr27, "pcap/succ/NGSetupResponse.pcap"),
	{ok, File28} = file:open("bin/succ/PathSwitchRequestAcknowledge.bin",[read]),
	{ok, HexStr28} = file:read(File28,1024*1024),
	dump_sctp_packet(HexStr28, "pcap/succ/PathSwitchRequestAcknowledge.pcap"),
	{ok, File29} = file:open("bin/succ/PDUSessionResourceModifyResponse.bin",[read]),
	{ok, HexStr29} = file:read(File29,1024*1024),
	dump_sctp_packet(HexStr29, "pcap/succ/PDUSessionResourceModifyResponse.pcap"),
	{ok, File210} = file:open("bin/succ/PDUSessionResourceModifyConfirm.bin",[read]),
	{ok, HexStr210} = file:read(File210,1024*1024),
	dump_sctp_packet(HexStr210, "pcap/succ/PDUSessionResourceModifyConfirm.pcap"),
	{ok, File211} = file:open("bin/succ/PDUSessionResourceReleaseResponse.bin",[read]),
	{ok, HexStr211} = file:read(File211,1024*1024),
	dump_sctp_packet(HexStr211, "pcap/succ/PDUSessionResourceReleaseResponse.pcap"),
	{ok, File212} = file:open("bin/succ/PDUSessionResourceSetupResponse.bin",[read]),
	{ok, HexStr212} = file:read(File212,1024*1024),
	dump_sctp_packet(HexStr212, "pcap/succ/PDUSessionResourceSetupResponse.pcap"),
	{ok, File213} = file:open("bin/succ/PWSCancelResponse.bin",[read]),
	{ok, HexStr213} = file:read(File213,1024*1024),
	dump_sctp_packet(HexStr213, "pcap/succ/PWSCancelResponse.pcap"),
	{ok, File214} = file:open("bin/succ/RANConfigurationUpdateAcknowledge.bin",[read]),
	{ok, HexStr214} = file:read(File214,1024*1024),
	dump_sctp_packet(HexStr214, "pcap/succ/RANConfigurationUpdateAcknowledge.pcap"),
	{ok, File215} = file:open("bin/succ/UEContextModificationResponse.bin",[read]),
	{ok, HexStr215} = file:read(File215,1024*1024),
	dump_sctp_packet(HexStr215, "pcap/succ/UEContextModificationResponse.pcap"),
	{ok, File216} = file:open("bin/succ/UEContextReleaseComplete.bin",[read]),
	{ok, HexStr216} = file:read(File216,1024*1024),
	dump_sctp_packet(HexStr216, "pcap/succ/UEContextReleaseComplete.pcap"),
	{ok, File217} = file:open("bin/succ/UERadioCapabilityCheckResponse.bin",[read]),
	{ok, HexStr217} = file:read(File217,1024*1024),
	dump_sctp_packet(HexStr217, "pcap/succ/UERadioCapabilityCheckResponse.pcap"),
	{ok, File218} = file:open("bin/succ/WriteReplaceWarningResponse.bin",[read]),
	{ok, HexStr218} = file:read(File218,1024*1024),
	dump_sctp_packet(HexStr218, "pcap/succ/WriteReplaceWarningResponse.pcap"),

	%%unsu
	{ok, File31} = file:open("bin/unsu/AMFConfigurationUpdateFailure.bin",[read]),
	{ok, HexStr31} = file:read(File31,1024*1024),
	dump_sctp_packet(HexStr31, "pcap/unsu/AMFConfigurationUpdateFailure.pcap"),
	{ok, File32} = file:open("bin/unsu/HandoverPreparationFailure.bin",[read]),
	{ok, HexStr32} = file:read(File32,1024*1024),
	dump_sctp_packet(HexStr32, "pcap/unsu/HandoverPreparationFailure.pcap"),
	{ok, File33} = file:open("bin/unsu/HandoverFailure.bin",[read]),
	{ok, HexStr33} = file:read(File33,1024*1024),
	dump_sctp_packet(HexStr33, "pcap/unsu/HandoverFailure.pcap"),
	{ok, File34} = file:open("bin/unsu/InitialContextSetupFailure.bin",[read]),
	{ok, HexStr34} = file:read(File34,1024*1024),
	dump_sctp_packet(HexStr34, "pcap/unsu/InitialContextSetupFailure.pcap"),
	{ok, File35} = file:open("bin/unsu/NGSetupFailure.bin",[read]),
	{ok, HexStr35} = file:read(File35,1024*1024),
	dump_sctp_packet(HexStr35, "pcap/unsu/NGSetupFailure.pcap"),
	{ok, File36} = file:open("bin/unsu/PathSwitchRequestFailure.bin",[read]),
	{ok, HexStr36} = file:read(File36,1024*1024),
	dump_sctp_packet(HexStr36, "pcap/unsu/PathSwitchRequestFailure.pcap"),
	{ok, File37} = file:open("bin/unsu/RANConfigurationUpdateFailure.bin",[read]),
	{ok, HexStr37} = file:read(File37,1024*1024),
	dump_sctp_packet(HexStr37, "pcap/unsu/RANConfigurationUpdateFailure.pcap"),
	{ok, File38} = file:open("bin/unsu/UEContextModificationFailure.bin",[read]),
	{ok, HexStr38} = file:read(File38,1024*1024),
	dump_sctp_packet(HexStr38, "pcap/unsu/UEContextModificationFailure.pcap").
